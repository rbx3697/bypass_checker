{% extends "base.html" %}

{% block content %}
<div class="card">
    <h2>üìä –õ–∏—á–Ω—ã–π –∫–∞–±–∏–Ω–µ—Ç</h2>
    
    <div class="user-info">
        <div class="info-item">
            <span class="info-label">ID –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è:</span>
            <span class="info-value">{{ user_id[:8] }}...</span>
        </div>
        <div class="info-item">
            <span class="info-label">–ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω:</span>
            <span class="info-value">{{ user_data.get('created_at', '–°–µ–≥–æ–¥–Ω—è')[:16] }}</span>
        </div>
    </div>
</div>

<div class="card">
    <h2>üìà –í–∞—à–∞ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞</h2>
    
    <div class="stats-grid">
        <div class="stat-card">
            <div class="stat-icon">üîç</div>
            <div class="stat-info">
                <div class="stat-number" id="user-check-count">{{ user_data.get('check_count', 0) }}</div>
                <div class="stat-label">–ü—Ä–æ–≤–µ—Ä–µ–Ω–æ –∞–∫–∫–∞—É–Ω—Ç–æ–≤</div>
            </div>
        </div>
        
        <div class="stat-card">
            <div class="stat-icon">üîì</div>
            <div class="stat-info">
                <div class="stat-number" id="user-bypass-count">{{ user_data.get('bypass_count', 0) }}</div>
                <div class="stat-label">Bypass –æ–ø–µ—Ä–∞—Ü–∏–π</div>
            </div>
        </div>
    </div>
</div>

<div class="card">
    <h2>üïí –ü–æ—Å–ª–µ–¥–Ω—è—è –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å</h2>
    
    <div class="activity-list">
        <div class="activity-item">
            <span class="activity-label">–ü–æ—Å–ª–µ–¥–Ω—è—è –ø—Ä–æ–≤–µ—Ä–∫–∞:</span>
            <span class="activity-value" id="last-check">{{ user_data.get('last_check', '–ù–∏–∫–æ–≥–¥–∞') }}</span>
        </div>
        <div class="activity-item">
            <span class="activity-label">–ü–æ—Å–ª–µ–¥–Ω–∏–π bypass:</span>
            <span class="activity-value" id="last-bypass">{{ user_data.get('last_bypass', '–ù–∏–∫–æ–≥–¥–∞') }}</span>
        </div>
    </div>
</div>

<script>
// –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
function updateUserStats() {
    fetch('/api/user_stats')
        .then(response => response.json())
        .then(data => {
            document.getElementById('user-check-count').textContent = data.check_count;
            document.getElementById('user-bypass-count').textContent = data.bypass_count;
            document.getElementById('last-check').textContent = data.last_check;
            document.getElementById('last-bypass').textContent = data.last_bypass;
        });
}

setInterval(updateUserStats, 5000);
updateUserStats();
</script>
{% endblock %}